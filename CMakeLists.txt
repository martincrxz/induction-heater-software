cmake_minimum_required(VERSION 3.1.0)
project(TrabajoProfesional)
# Para producci√≥n
#set (CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -O3 -std=c++11 -Wall -Werror -pedantic -pthread")
# Para debug
set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -O0 -std=c++11 -ggdb -Wall -Werror -pedantic -pthread")

if(${CMAKE_SYSTEM_NAME} STREQUAL "Darwin")
	message("[INFO] COMPILING FOR MACOS")
	set(CMAKE_PREFIX_PATH "/usr/local/Cellar/qt/5.12.2/")
else()
	message("[INFO] COMPILING FOR LINUX")
endif()

message("[INFO] Adding '${CMAKE_SOURCE_DIR}/libs' as include directory")
include_directories(${CMAKE_SOURCE_DIR}/libs)

message("[INFO] Loading sources")
file(GLOB_RECURSE SOURCES RELATIVE ${CMAKE_SOURCE_DIR} "src/*.cpp" "src/*.h" "libs/*.h" "libs/*.cpp")

message("[INFO] Loading sources of QT")

# Find the QtWidgets library
find_package(Qt5 REQUIRED COMPONENTS Core Widgets Charts)
#find_package(Qt5Widgets CONFIG REQUIRED)
#find_package(Qt5Core)

qt5_wrap_ui(UIS_HEADERS
        src/view/auto_tunning_tab_view.ui
        src/view/automatic_control_tab_view.ui
        src/view/chart_tab_view.ui
        src/view/equipment_status_view.ui
        src/view/general_view.ui
        src/view/manual_power_control_view.ui
        )
# Instruct CMake to run moc automatically when neededcd
set(CMAKE_AUTOMOC ON)
# Create code from a list of Qt designer ui files
set(CMAKE_AUTORCC ON)

# Adding directory with the autogenerated headers as include directory
message("[INFO] Adding '${PROJECT_BINARY_DIR}' as include directory")
include_directories(${PROJECT_BINARY_DIR})

message("[INFO] Headers autogenerated: ${UIS_HEADERS}")

file(GLOB RESOURCES ${CMAKE_SOURCE_DIR}
        "assets/resources.qrc")

# Tell CMake to create the helloworld executable
add_executable(application ${SOURCES} ${UIS_HEADERS} ${RESOURCES})
# Use the Widgets module from Qt 5
target_link_libraries(application Qt5::Core Qt5::Widgets Qt5::Charts)

# Install phase (commented until necessary)
#file(COPY assets DESTINATION ./)
#file(COPY serverConfig.yaml DESTINATION ./)
#file(COPY defaultWeapons.yaml DESTINATION ./)
#file(COPY res DESTINATION ./)

#message("[INFO] Adding Installation directives")
#INSTALL(TARGETS worms_client worms_server worms_editor DESTINATION /usr/bin)
#INSTALL(DIRECTORY assets DESTINATION /var/Worms)
#INSTALL(DIRECTORY res DESTINATION /var/Worms)
#INSTALL(FILES defaultWeapons.yaml serverConfig.yaml DESTINATION /etc/Worms)